# Homarr specific configuration
homarr:
  image:
    repository: ghcr.io/homarr-labs/homarr
    tag: "v1.33.0"
    pullPolicy: Always

  service:
    type: ClusterIP
    port: 80
    targetPort: 3000

  ingress:
    enabled: true
    className: "traefik"
    annotations:
      kubernetes.io/ingress.class: traefik
    hosts:
      - host: nezdemkovski.cloud
        paths:
          - path: /
            pathType: ImplementationSpecific

  persistence:
    enabled: true
    size: 2Gi # Storage for Homarr configuration and data
    storageClass: "longhorn"
    accessModes:
      - ReadWriteOnce

  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 512Mi

  # Environment variables for Homarr
  env:
    - name: SECRET_ENCRYPTION_KEY
      valueFrom:
        secretKeyRef:
          name: homelab-apps-secrets
          key: homarr-encryption-key

    # Security context - Run as root to avoid permission issues
  podSecurityContext:
    fsGroup: 999

  securityContext:
    runAsNonRoot: false
    runAsUser: 0
    runAsGroup: 0
    readOnlyRootFilesystem: false

  # Health checks
  livenessProbe:
    httpGet:
      path: /
      port: http
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

  readinessProbe:
    httpGet:
      path: /
      port: http
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

  nodeSelector: {}
