# Open WebUI specific configuration
open-webui:
  image:
    repository: ghcr.io/open-webui/open-webui
    tag: "v0.6.22"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 80
    targetPort: 8080

  ingress:
    enabled: true
    className: "traefik"
    annotations:
      kubernetes.io/ingress.class: traefik
      # No SSL annotations needed - Cloudflare handles SSL termination
    hosts:
      - host: ai.nezdemkovski.cloud
        paths:
          - path: /
            pathType: ImplementationSpecific
    # No TLS section needed - Cloudflare Tunnel handles SSL

  persistence:
    enabled: true
    size: 10Gi
    storageClass: "longhorn"
    accessModes:
      - ReadWriteOnce

  resources:
    limits:
      cpu: 1000m
      memory: 2Gi
    requests:
      cpu: 100m
      memory: 512Mi

  # Environment variables for Open WebUI
  env:
    - name: WEBUI_NAME
      value: "AI Assistant"
    - name: DEFAULT_USER_ROLE
      value: "user"

  # Security context - Run as non-root for security
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1000
    runAsGroup: 1000
    fsGroup: 1000
    seccompProfile:
      type: RuntimeDefault

  securityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false # Open WebUI needs write access for data
    runAsNonRoot: true
    runAsUser: 1000
    runAsGroup: 1000
    capabilities:
      drop:
        - ALL

  nodeSelector: {}
